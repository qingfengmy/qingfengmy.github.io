(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[9317],{78023:function(M){M.exports={container:"container___1ridQ",innerContainer:"innerContainer___VdXfI",currentArea:"currentArea___3acGt",popContainer:"popContainer___ZZeli",formContent:"formContent___1b7aM",title:"title___1CnBv",radios:"radios___jMikF",btns:"btns___2Vgte",content:"content___y0E26",weekList:"weekList___1pmQ_",weekItem:"weekItem___3iIvk",timeList:"timeList___31Zcw",timeItem:"timeItem___3C34X",hourList:"hourList___O6nTF",hourItem:"hourItem___3k8qh",dotList:"dotList___12oUD",dotItem:"dotItem___BoKMj",footer:"footer___30DaZ",helpDot:"helpDot___3cmq0",helpText:"helpText___3JRER",helpTip:"helpTip___WpGik"}},65856:function(M,I,o){"use strict";o.r(I),o.d(I,{default:function(){return oe}});var A=o(2824),w=o(67294),O=o(21010),P=o(58363),de=o(57663),L=o(71577),he=o(88983),Z=o(47933),me=o(77883),G=o(85482),W=o(3182),y=o(11849),z=o(69610),J=o(54941),U=o(81306),X=o(59206),K=o(94043),V=o.n(K),B=o(67607),x=o(96486),Q=o(78023),l=o.n(Q),Y=o(93224),D=o(86582),q=[{timeSpanList:[{time:"00:00-24:00",discount:0}]},{timeSpanList:[{time:"00:00-24:00",discount:0}]},{timeSpanList:[{time:"00:00-24:00",discount:0}]},{timeSpanList:[{time:"00:00-24:00",discount:0}]},{timeSpanList:[{time:"00:00-24:00",discount:0}]},{timeSpanList:[{time:"00:00-24:00",discount:0}]},{timeSpanList:[{time:"00:00-24:00",discount:0}]}],k=[{week:1,name:"\u4E00",fullName:"\u661F\u671F\u4E00"},{week:2,name:"\u4E8C",fullName:"\u661F\u671F\u4E8C"},{week:3,name:"\u4E09",fullName:"\u661F\u671F\u4E09"},{week:4,name:"\u56DB",fullName:"\u661F\u671F\u56DB"},{week:5,name:"\u4E94",fullName:"\u661F\u671F\u4E94"},{week:6,name:"\u516D",fullName:"\u661F\u671F\u516D"},{week:7,name:"\u4E03",fullName:"\u661F\u671F\u4E03"}],H=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23];function T(i){return i>9?i:"".concat(0,i)}function R(){var i=[];return k.forEach(function(u){H.forEach(function(c){i.push({id:"w".concat(u.week,"-").concat(c),week:u.week,hour:c,isSelect:!1,radioType:1,discount:0})})}),i}var $;function fe(){return $}function pe(i){if(i){$=i;var u=[];try{u=JSON.parse(i)}catch(c){console.error(c)}return E(u)}return E(q)}function E(i){var u=R();if((0,x.isEmpty)(i))return u;var c=u.map(function(s){var e=(0,y.Z)({},s),n=i[e.week-1],a=n.timeSpanList.find(function(r){var d=r.time.split("-"),h=Number(d[0].split(":")[0]),S=Number(d[1].split(":")[0]),g=e.hour>=h&&e.hour<S;return g});return a?e.discount=a.discount:e.discount=0,e});return c}function _(i){var u=[];return i.reduce(function(c,s){var e=c[s.week-1];if((0,x.isEmpty)(e))return[].concat((0,D.Z)(c),[{timeSpanList:[{time:"".concat(T(s.hour),":00-").concat(T(s.hour+1),":00"),discount:s.discount}]}]);var n=c.slice(0,c.length-1),a=e.timeSpanList[e.timeSpanList.length-1],r=e.timeSpanList.slice(0,e.timeSpanList.length-1);if(a.discount===s.discount){var d=a.time.split("-");return[].concat((0,D.Z)(n),[{timeSpanList:[].concat((0,D.Z)(r),[(0,y.Z)((0,y.Z)({},a),{},{time:"".concat(d[0],"-").concat(T(s.hour+1),":00")})])}])}return[].concat((0,D.Z)(n),[{timeSpanList:[].concat((0,D.Z)(e.timeSpanList),[{time:"".concat(T(s.hour),":00-").concat(T(s.hour+1),":00"),discount:s.discount}])}])},u)}function ee(i){return i>=30&&i<=100?"rgba(97,199,242,".concat((i/10-3)*.05+.05,")"):i>100&&i<200?"rgba(77,166,255,".concat((i/10-2)*.05+.2,")"):i>=200&&i<=250?"rgba(134,115,230,".concat((i/10-2)*.05+.3,")"):"#ffffff"}function te(i){var u=(0,x.isEmpty)(i)?1:Math.min.apply(Math,(0,D.Z)(i.map(function(s){return s.week||1}))),c=(0,x.isEmpty)(i)?0:Math.min.apply(Math,(0,D.Z)(i.map(function(s){return s.hour||0})));return i.find(function(s){return s.week===u&&s.hour===c})}function ne(i){var u=(0,x.isEmpty)(i)?1:Math.max.apply(Math,(0,D.Z)(i.map(function(s){return s.week||1}))),c=(0,x.isEmpty)(i)?0:Math.max.apply(Math,(0,D.Z)(i.map(function(s){return s.hour||0})));return i.find(function(s){return s.week===u&&s.hour===c})}var t=o(85893),ae=function(u){var c=u.selectableRef,s=u.item,e=u.isSelecting,n=u.isSelected,a=(0,Y.Z)(u,["selectableRef","item","isSelecting","isSelected"]);return(0,t.jsx)("li",(0,y.Z)({ref:c,className:l().dotItem,style:{width:32,height:40,backgroundColor:ee(s.discount)}},a),s.id)},ie=(0,B.Lr)(ae),se=function(i){(0,U.Z)(c,i);var u=(0,X.Z)(c);function c(s){var e;return(0,z.Z)(this,c),e=u.call(this,s),e.contentRef=void 0,e.getSelectableGroupRef=void 0,e.handleCalcSelectableBoxDisplay=function(){var n=document.querySelector(".selectable-selectbox");(n==null?void 0:n.style.width)==="0px"&&n.style.height==="0px"&&(n.style.display="none")},e.handleSelecting=function(){var n=document.querySelector(".selectable-selectbox");(n==null?void 0:n.style.display)==="none"&&(n.style.display="");var a=e.state,r=a.isSelecting,d=a.showTip;r||e.setState({isSelecting:!0}),d&&e.setState({showTip:!1})},e.handleRadioType=function(n){var a=e.state.formValues,r=n.target.value;e.setState({formValues:(0,y.Z)((0,y.Z)({},a),{},{radioType:r})})},e.handleDiscountChange=function(n){var a=e.state.formValues;e.setState({formValues:(0,y.Z)((0,y.Z)({},a),{},{discount:n})})},e.handleDotFormOk=(0,W.Z)(V().mark(function n(){var a,r,d,h,S,g;return V().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:a=e.state,r=a.startDot,d=a.endDot,h=a.formValues,S=a.dots,g=S.map(function(f){var p=(0,y.Z)({},f);if(p.week>=r.week&&p.week<=d.week&&p.hour>=r.hour&&p.hour<=d.hour){var j=0;h.radioType===3?j=0:h.radioType===2?j=100:h.radioType===1&&(j=h.discount||0),p=(0,y.Z)((0,y.Z)({},p),{},{discount:j})}return p}),e.setState({isSelect:!1,dots:g},e.handleChange);case 3:case"end":return m.stop()}},n)})),e.handleDotFormCancel=function(){e.setState({isSelect:!1})},e.handleClear=function(){var n=e.state.emptyDots;e.setState({dots:n},e.handleChange)},e.handleChange=function(){var n=e.state.dots,a=_(n),r=e.props.onChange;r&&r(a)},e.validate=function(){var n=e.state.dots;return n.some(function(a){return a.discount!==0})},e.handleSelectionFinish=function(n){var a,r,d,h;if(e.handleCalcSelectableBoxDisplay(),!(0,x.isEmpty)(n)){var S=32,g=40,C=n.map(function(F){return F.props.item}),m=te(C),f=ne(C),p=((a=m==null?void 0:m.hour)!==null&&a!==void 0?a:0)*S,j=(((r=f==null?void 0:f.hour)!==null&&r!==void 0?r:1)+1)*S,N=(((d=m==null?void 0:m.week)!==null&&d!==void 0?d:1)-1)*g,b=((h=f==null?void 0:f.week)!==null&&h!==void 0?h:0)*g;e.setState({isSelecting:!1,isSelect:!0,startDot:m,endDot:f,selectRect:{left:p,right:j,top:N,bottom:b,centerX:p+(j-p)/2,centerY:N+(b-N)/2}},function(){e.getSelectableGroupRef.current.clearSelection()})}},e.handleShowTip=function(n){var a=e.state,r=a.isSelect,d=a.isSelecting;r||d||e.setState({showTip:!0,currentTip:n})},e.handleHideTip=function(n){var a=e.state,r=a.isSelect,d=a.isSelecting;r||d||e.setState({showTip:!1,currentTip:{}})},e.state={dots:R(),emptyDots:[],formValues:{radioType:1,discount:void 0},isSelect:!1,isSelecting:!1,selectRect:{},startDot:{},endDot:{},currentTip:{},showTip:!1},e.contentRef=w.createRef(),e.getSelectableGroupRef=w.createRef(),e}return(0,J.Z)(c,[{key:"componentDidMount",value:function(){var e=R(),n=this.props.value,a=e;(0,x.isEmpty)(n)||(a=E(n)),this.setState({emptyDots:e,dots:a}),this.handleCalcSelectableBoxDisplay()}},{key:"componentDidUpdate",value:function(e){var n=this.props.value;if(!(0,x.isEmpty)(n)&&JSON.stringify(n)!==JSON.stringify(e.value)){var a=E(n);this.setState({dots:a,isSelect:!1,formValues:{radioType:1,discount:void 0}})}}},{key:"render",value:function(){var e,n,a=this,r=this.state,d=r.dots,h=r.selectRect,S=r.isSelect,g=r.startDot,C=r.endDot,m=r.formValues,f=r.currentTip,p=r.showTip,j=this.props.disabled;console.log("render",this.state);var N=m.radioType===1&&(m.discount===void 0||m.discount<30||m.discount>250),b=32,F=40,ce=["--","\u661F\u671F\u4E00","\u661F\u671F\u4E8C","\u661F\u671F\u4E09","\u661F\u671F\u56DB","\u661F\u671F\u4E94","\u661F\u671F\u516D","\u661F\u671F\u65E5"];return(0,t.jsx)("div",{className:l().container,children:(0,t.jsxs)("div",{style:{width:800},className:l().innerContainer,children:[S&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:l().currentArea,id:"selectArea",style:{top:64+h.top,left:32+h.left,height:h.bottom-h.top,width:h.right-h.left,minHeight:2,minWidth:2}}),(0,t.jsxs)("div",{style:{top:64+h.centerY,left:32+h.centerX,display:S?"":"none"},className:l().popContainer,children:[(0,t.jsxs)("div",{className:l().formContent,children:[(0,t.jsxs)("div",{className:l().title,children:[(0,t.jsxs)("span",{children:[k[((e=g==null?void 0:g.week)!==null&&e!==void 0?e:1)-1].fullName,"-",k[((n=C==null?void 0:C.week)!==null&&n!==void 0?n:1)-1].fullName]}),":",(0,t.jsxs)("strong",{style:{marginLeft:5},children:[g.hour,":00 -",C.hour,":00"]})]}),(0,t.jsxs)(Z.ZP.Group,{className:l().radios,value:m.radioType,onChange:this.handleRadioType,children:[(0,t.jsxs)(Z.ZP,{value:1,children:["\u81EA\u5B9A\u4E49",(0,t.jsxs)("div",{style:{display:"inline-flex",flexDirection:"column"},children:[(0,t.jsx)(G.Z,{value:m.discount,onChange:this.handleDiscountChange,disabled:m.radioType!==1,size:"small",style:{marginLeft:5,marginRight:5,borderColor:N?"#d52112":""}}),N&&(0,t.jsx)("span",{style:{color:"#d52112"},children:"\u8303\u56F4:30-250\u7684\u6574\u6570"})]}),(0,t.jsx)("span",{children:"%"})]}),(0,t.jsx)(Z.ZP,{value:2,style:{width:64},children:"\u65E0\u6298\u6263"}),(0,t.jsx)(Z.ZP,{value:3,style:{width:64},children:"\u4E0D\u6295\u653E"})]})]}),(0,t.jsxs)("div",{className:l().btns,children:[(0,t.jsx)(L.Z,{disabled:N,size:"small",onClick:this.handleDotFormOk,type:"primary",children:"\u786E\u5B9A"}),(0,t.jsx)(L.Z,{size:"small",onClick:this.handleDotFormCancel,style:{marginLeft:5},children:"\u53D6\u6D88"})]})]})]}),(0,t.jsx)("div",{style:{top:62+(f.week||0)*F,left:32+((f.hour||0)+1)*b,display:p?"":"none"},className:l().popContainer,children:(0,t.jsx)("div",{className:l().formContent,children:(0,t.jsxs)("div",{className:l().title,style:{display:"flex",flexDirection:"column"},children:[(0,t.jsx)("span",{children:ce[f.week]}),(0,t.jsx)("strong",{children:"".concat(f.hour,":00 - ").concat(f.hour+1,":00")}),(0,t.jsx)("strong",{children:"".concat(f.discount,"%\u6298\u6263")})]})})}),(0,t.jsxs)("div",{className:l().content,style:{width:800},children:[(0,t.jsxs)("ul",{className:l().weekList,style:{width:32},children:[(0,t.jsx)("li",{className:l().weekItem,style:{height:61,lineHeight:"60px"},children:"\u661F\u671F"},"\u661F\u671F"),k.map(function(v){return(0,t.jsx)("li",{className:l().weekItem,style:{height:40,lineHeight:"40px"},children:v.name},v.name)})]}),(0,t.jsxs)("div",{className:l().rightContent,style:{width:768},children:[(0,t.jsx)("ul",{className:l().timeList,children:["00:00 - 06:00","06:00 - 12:00","12:00 - 18:00","18:00 - 24:00"].map(function(v){return(0,t.jsx)("li",{className:l().timeItem,style:{width:192,height:30,lineHeight:"30px"},children:v},v)})}),(0,t.jsx)("ul",{className:l().hourList,children:H.map(function(v){return(0,t.jsx)("li",{className:l().hourItem,style:{width:32,height:30,lineHeight:"30px"},children:v},v)})}),(0,t.jsx)(B.kn,{ref:this.getSelectableGroupRef,className:"main",enableDeselect:!0,disabled:j,allowClickWithoutSelected:!1,duringSelection:this.handleSelecting,onSelectionFinish:this.handleSelectionFinish,children:(0,t.jsx)("ul",{className:l().dotList,ref:this.contentRef,children:d.map(function(v){return(0,t.jsx)(ie,{item:v,onMouseOver:function(){return a.handleShowTip(v)},onMouseOut:function(){return a.handleHideTip(v)}},v.id)})})})]})]}),(0,t.jsxs)("div",{className:l().footer,children:[(0,t.jsx)(L.Z,{size:"small",style:{marginRight:10},type:"primary",onClick:this.handleClear,children:"\u6E05\u7A7A"}),(0,t.jsxs)("span",{className:"fr lh28 color-c",children:[(0,t.jsx)("span",{className:l().helpDot,style:{backgroundColor:"rgba(97,199,242,0.2)"}}),(0,t.jsx)("span",{className:l().helpText,children:"30-100%"}),(0,t.jsx)("span",{className:l().helpDot,style:{backgroundColor:"rgba(77,166,255,0.4)"}}),(0,t.jsx)("span",{className:l().helpText,children:"100-200%"}),(0,t.jsx)("span",{className:l().helpDot,style:{backgroundColor:"rgba(134,115,230,0.4)"}}),(0,t.jsx)("span",{className:l().helpText,children:"200-250%"}),(0,t.jsx)("span",{className:l().helpTip,children:"\u53EF\u4EE5\u62D6\u62FD\u9F20\u6807\u9009\u62E9\u6295\u653E\u65F6\u6BB5"})]})]})]})})}}]),c}(w.Component),re=se,le=function(){var u=(0,w.useState)([]),c=(0,A.Z)(u,2),s=c[0],e=c[1];return(0,t.jsx)(P.ZP,{header:{style:{borderBottom:"1px solid #ddd"},title:"svg",onBack:function(){return O.m8.push("/")}},children:(0,t.jsx)(re,{value:s,onChange:function(a){return e(a)}})})},oe=le}}]);
