"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[794],{74259:function(Ce,M,i){i.r(M),i.d(M,{default:function(){return xe}});var W=i(30577),$=i.n(W),E=i(93236),z=i(75229),G=i(6834),Z=i(58357),A=i.n(Z),U=i(71977),J=i.n(U),Y=i(86378),x=i.n(Y),X=i(14557),K=i.n(X),Q=i(39712),q=i.n(Q),_=i(89617),v=i.n(_),ee=i(64698),te=i.n(ee),ne=i(62898),ae=i.n(ne),se=i(24047),p=i.n(se),L=i(28918),ie=i(85042),P=i(12846),B=i(62856),j=i(32699),o={container:"container___IomLF",innerContainer:"innerContainer___I5GaD",currentArea:"currentArea___SSiQz",popContainer:"popContainer___sm_u2",formContent:"formContent___Poz52",title:"title___hZt82",radios:"radios___YhLNO",btns:"btns___Oyotg",content:"content___y64Di",weekList:"weekList___zaP_E",weekItem:"weekItem___EbiU9",timeList:"timeList___csWVG",timeItem:"timeItem___t__hG",hourList:"hourList___Vp0WC",hourItem:"hourItem___d7yBy",dotList:"dotList___u_hey",dotItem:"dotItem___Ng3W7",footer:"footer___dwRx8",helpDot:"helpDot___TIHSn",helpText:"helpText___V1k2_",helpTip:"helpTip____BO8U"},le=i(28488),re=i.n(le),oe=i(90967),C=i.n(oe),ue=[{timeSpanList:[{time:"00:00-24:00",discount:0}]},{timeSpanList:[{time:"00:00-24:00",discount:0}]},{timeSpanList:[{time:"00:00-24:00",discount:0}]},{timeSpanList:[{time:"00:00-24:00",discount:0}]},{timeSpanList:[{time:"00:00-24:00",discount:0}]},{timeSpanList:[{time:"00:00-24:00",discount:0}]},{timeSpanList:[{time:"00:00-24:00",discount:0}]}],R=[{week:1,name:"\u4E00",fullName:"\u661F\u671F\u4E00"},{week:2,name:"\u4E8C",fullName:"\u661F\u671F\u4E8C"},{week:3,name:"\u4E09",fullName:"\u661F\u671F\u4E09"},{week:4,name:"\u56DB",fullName:"\u661F\u671F\u56DB"},{week:5,name:"\u4E94",fullName:"\u661F\u671F\u4E94"},{week:6,name:"\u516D",fullName:"\u661F\u671F\u516D"},{week:7,name:"\u4E03",fullName:"\u661F\u671F\u4E03"}],H=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23];function k(s){return s>9?s:"".concat(0,s)}function F(){var s=[];return R.forEach(function(c){H.forEach(function(u){s.push({id:"w".concat(c.week,"-").concat(u),week:c.week,hour:u,isSelect:!1,radioType:1,discount:0})})}),s}var O;function Ne(){return O}function Te(s){if(s){O=s;var c=[];try{c=JSON.parse(s)}catch(u){console.error(u)}return b(c)}return b(ue)}function b(s){var c=F();if((0,j.isEmpty)(s))return c;var u=c.map(function(l){var e=x()({},l),n=s[e.week-1],a=n.timeSpanList.find(function(r){var d=r.time.split("-"),h=Number(d[0].split(":")[0]),D=Number(d[1].split(":")[0]),S=e.hour>=h&&e.hour<D;return S});return a?e.discount=a.discount:e.discount=0,e});return u}function ce(s){var c=[];return s.reduce(function(u,l){var e=u[l.week-1];if((0,j.isEmpty)(e))return[].concat(C()(u),[{timeSpanList:[{time:"".concat(k(l.hour),":00-").concat(k(l.hour+1),":00"),discount:l.discount}]}]);var n=u.slice(0,u.length-1),a=e.timeSpanList[e.timeSpanList.length-1],r=e.timeSpanList.slice(0,e.timeSpanList.length-1);if(a.discount===l.discount){var d=a.time.split("-");return[].concat(C()(n),[{timeSpanList:[].concat(C()(r),[x()(x()({},a),{},{time:"".concat(d[0],"-").concat(k(l.hour+1),":00")})])}])}return[].concat(C()(n),[{timeSpanList:[].concat(C()(e.timeSpanList),[{time:"".concat(k(l.hour),":00-").concat(k(l.hour+1),":00"),discount:l.discount}])}])},c)}function de(s){return s>=30&&s<=100?"rgba(97,199,242,".concat((s/10-3)*.05+.05,")"):s>100&&s<200?"rgba(77,166,255,".concat((s/10-2)*.05+.2,")"):s>=200&&s<=250?"rgba(134,115,230,".concat((s/10-2)*.05+.3,")"):"#ffffff"}function he(s){var c=(0,j.isEmpty)(s)?1:Math.min.apply(Math,C()(s.map(function(l){return l.week||1}))),u=(0,j.isEmpty)(s)?0:Math.min.apply(Math,C()(s.map(function(l){return l.hour||0})));return s.find(function(l){return l.week===c&&l.hour===u})}function me(s){var c=(0,j.isEmpty)(s)?1:Math.max.apply(Math,C()(s.map(function(l){return l.week||1}))),u=(0,j.isEmpty)(s)?0:Math.max.apply(Math,C()(s.map(function(l){return l.hour||0})));return s.find(function(l){return l.week===c&&l.hour===u})}var t=i(62086),fe=["selectableRef","item","isSelecting","isSelected"],ve=function(c){var u=c.selectableRef,l=c.item,e=c.isSelecting,n=c.isSelected,a=re()(c,fe);return(0,t.jsx)("li",x()({ref:u,className:o.dotItem,style:{width:31,height:40,backgroundColor:de(l.discount)}},a),l.id)},pe=(0,B.Lr)(ve),ye=function(s){te()(u,s);var c=ae()(u);function u(l){var e;return K()(this,u),e=c.call(this,l),p()(v()(e),"contentRef",void 0),p()(v()(e),"getSelectableGroupRef",void 0),p()(v()(e),"handleCalcSelectableBoxDisplay",function(){var n=document.querySelector(".selectable-selectbox");(n==null?void 0:n.style.width)==="0px"&&n.style.height==="0px"&&(n.style.display="none")}),p()(v()(e),"handleSelecting",function(){var n=document.querySelector(".selectable-selectbox");(n==null?void 0:n.style.display)==="none"&&(n.style.display="");var a=e.state,r=a.isSelecting,d=a.showTip;r||e.setState({isSelecting:!0}),d&&e.setState({showTip:!1})}),p()(v()(e),"handleRadioType",function(n){var a=e.state.formValues,r=n.target.value;e.setState({formValues:x()(x()({},a),{},{radioType:r})})}),p()(v()(e),"handleDiscountChange",function(n){var a=e.state.formValues;e.setState({formValues:x()(x()({},a),{},{discount:n})})}),p()(v()(e),"handleDotFormOk",J()(A()().mark(function n(){var a,r,d,h,D,S;return A()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:a=e.state,r=a.startDot,d=a.endDot,h=a.formValues,D=a.dots,S=D.map(function(f){var y=x()({},f);if(y.week>=r.week&&y.week<=d.week&&y.hour>=r.hour&&y.hour<=d.hour){var N=0;h.radioType===3?N=0:h.radioType===2?N=100:h.radioType===1&&(N=h.discount||0),y=x()(x()({},y),{},{discount:N})}return y}),e.setState({isSelect:!1,dots:S},e.handleChange);case 3:case"end":return m.stop()}},n)}))),p()(v()(e),"handleDotFormCancel",function(){e.setState({isSelect:!1})}),p()(v()(e),"handleClear",function(){var n=e.state.emptyDots;e.setState({dots:n},e.handleChange)}),p()(v()(e),"handleChange",function(){var n=e.state.dots,a=ce(n),r=e.props.onChange;r&&r(a)}),p()(v()(e),"validate",function(){var n=e.state.dots;return n.some(function(a){return a.discount!==0})}),p()(v()(e),"handleSelectionFinish",function(n){var a,r,d,h;if(e.handleCalcSelectableBoxDisplay(),!(0,j.isEmpty)(n)){var D=32,S=40,T=n.map(function(V){return V.props.item}),m=he(T),f=me(T),y=((a=m==null?void 0:m.hour)!==null&&a!==void 0?a:0)*D,N=(((r=f==null?void 0:f.hour)!==null&&r!==void 0?r:1)+1)*D,w=(((d=m==null?void 0:m.week)!==null&&d!==void 0?d:1)-1)*S,I=((h=f==null?void 0:f.week)!==null&&h!==void 0?h:0)*S;e.setState({isSelecting:!1,isSelect:!0,startDot:m,endDot:f,selectRect:{left:y,right:N,top:w,bottom:I,centerX:y+(N-y)/2,centerY:w+(I-w)/2}},function(){e.getSelectableGroupRef.current.clearSelection()})}}),p()(v()(e),"handleShowTip",function(n){var a=e.state,r=a.isSelect,d=a.isSelecting;r||d||e.setState({showTip:!0,currentTip:n})}),p()(v()(e),"handleHideTip",function(n){var a=e.state,r=a.isSelect,d=a.isSelecting;r||d||e.setState({showTip:!1,currentTip:{}})}),e.state={dots:F(),emptyDots:[],formValues:{radioType:1,discount:void 0},isSelect:!1,isSelecting:!1,selectRect:{},startDot:{},endDot:{},currentTip:{},showTip:!1},e.contentRef=E.createRef(),e.getSelectableGroupRef=E.createRef(),e}return q()(u,[{key:"componentDidMount",value:function(){var e=F(),n=this.props.value,a=e;(0,j.isEmpty)(n)||(a=b(n)),this.setState({emptyDots:e,dots:a}),this.handleCalcSelectableBoxDisplay()}},{key:"componentDidUpdate",value:function(e){var n=this.props.value;if(!(0,j.isEmpty)(n)&&JSON.stringify(n)!==JSON.stringify(e.value)){var a=b(n);this.setState({dots:a,isSelect:!1,formValues:{radioType:1,discount:void 0}})}}},{key:"render",value:function(){var e,n,a=this,r=this.state,d=r.dots,h=r.selectRect,D=r.isSelect,S=r.startDot,T=r.endDot,m=r.formValues,f=r.currentTip,y=r.showTip,N=this.props.disabled;console.log("render",this.state);var w=m.radioType===1&&(m.discount===void 0||m.discount<30||m.discount>250),I=32,V=40,De=["--","\u661F\u671F\u4E00","\u661F\u671F\u4E8C","\u661F\u671F\u4E09","\u661F\u671F\u56DB","\u661F\u671F\u4E94","\u661F\u671F\u516D","\u661F\u671F\u65E5"];return(0,t.jsx)("div",{className:o.container,children:(0,t.jsxs)("div",{style:{width:800},className:o.innerContainer,children:[D&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:o.currentArea,id:"selectArea",style:{top:64+h.top,left:32+h.left,height:h.bottom-h.top,width:h.right-h.left,minHeight:2,minWidth:2}}),(0,t.jsxs)("div",{style:{top:64+h.centerY,left:32+h.centerX,display:D?"":"none"},className:o.popContainer,children:[(0,t.jsxs)("div",{className:o.formContent,children:[(0,t.jsxs)("div",{className:o.title,children:[(0,t.jsxs)("span",{children:[R[((e=S==null?void 0:S.week)!==null&&e!==void 0?e:1)-1].fullName,"-",R[((n=T==null?void 0:T.week)!==null&&n!==void 0?n:1)-1].fullName]}),":",(0,t.jsxs)("strong",{style:{marginLeft:5},children:[S.hour,":00 -",T.hour,":00"]})]}),(0,t.jsxs)(L.ZP.Group,{className:o.radios,value:m.radioType,onChange:this.handleRadioType,children:[(0,t.jsxs)(L.ZP,{value:1,children:["\u81EA\u5B9A\u4E49",(0,t.jsxs)("div",{style:{display:"inline-flex",flexDirection:"column"},children:[(0,t.jsx)(ie.Z,{value:m.discount,onChange:this.handleDiscountChange,disabled:m.radioType!==1,size:"small",style:{marginLeft:5,marginRight:5,borderColor:w?"#d52112":""}}),w&&(0,t.jsx)("span",{style:{color:"#d52112"},children:"\u8303\u56F4:30-250\u7684\u6574\u6570"})]}),(0,t.jsx)("span",{children:"%"})]}),(0,t.jsx)(L.ZP,{value:2,children:"\u65E0\u6298\u6263"}),(0,t.jsx)(L.ZP,{value:3,children:"\u4E0D\u6295\u653E"})]})]}),(0,t.jsxs)("div",{className:o.btns,children:[(0,t.jsx)(P.ZP,{disabled:w,size:"small",onClick:this.handleDotFormOk,type:"primary",children:"\u786E\u5B9A"}),(0,t.jsx)(P.ZP,{size:"small",onClick:this.handleDotFormCancel,style:{marginLeft:5},children:"\u53D6\u6D88"})]})]})]}),(0,t.jsx)("div",{style:{top:62+(f.week||0)*V,left:32+((f.hour||0)+1)*I,display:y?"":"none"},className:o.popContainer,children:(0,t.jsx)("div",{className:o.formContent,children:(0,t.jsxs)("div",{className:o.title,style:{display:"flex",flexDirection:"column"},children:[(0,t.jsx)("span",{children:De[f.week]}),(0,t.jsx)("strong",{children:"".concat(f.hour,":00 - ").concat(f.hour+1,":00")}),(0,t.jsx)("strong",{children:"".concat(f.discount,"%\u6298\u6263")})]})})}),(0,t.jsxs)("div",{className:o.content,style:{width:800},children:[(0,t.jsxs)("ul",{className:o.weekList,style:{width:32},children:[(0,t.jsx)("li",{className:o.weekItem,style:{height:61,lineHeight:"60px"},children:"\u661F\u671F"},"\u661F\u671F"),R.map(function(g){return(0,t.jsx)("li",{className:o.weekItem,style:{height:40,lineHeight:"40px"},children:g.name},g.name)})]}),(0,t.jsxs)("div",{className:o.rightContent,style:{width:768},children:[(0,t.jsx)("ul",{className:o.timeList,children:["00:00 - 06:00","06:00 - 12:00","12:00 - 18:00","18:00 - 24:00"].map(function(g){return(0,t.jsx)("li",{className:o.timeItem,style:{width:192,height:30,lineHeight:"30px"},children:g},g)})}),(0,t.jsx)("ul",{className:o.hourList,children:H.map(function(g){return(0,t.jsx)("li",{className:o.hourItem,style:{width:32,height:30,lineHeight:"30px"},children:g},g)})}),(0,t.jsx)(B.kn,{ref:this.getSelectableGroupRef,className:"main",enableDeselect:!0,disabled:N,allowClickWithoutSelected:!1,duringSelection:this.handleSelecting,onSelectionFinish:this.handleSelectionFinish,children:(0,t.jsx)("ul",{className:o.dotList,ref:this.contentRef,children:d.map(function(g){return(0,t.jsx)(pe,{item:g,onMouseOver:function(){return a.handleShowTip(g)},onMouseOut:function(){return a.handleHideTip(g)}},g.id)})})})]})]}),(0,t.jsxs)("div",{className:o.footer,children:[(0,t.jsx)(P.ZP,{size:"small",style:{marginRight:10},type:"primary",onClick:this.handleClear,children:"\u6E05\u7A7A"}),(0,t.jsxs)("span",{className:"fr lh28 color-c",children:[(0,t.jsx)("span",{className:o.helpDot,style:{backgroundColor:"rgba(97,199,242,0.2)"}}),(0,t.jsx)("span",{className:o.helpText,children:"30-100%"}),(0,t.jsx)("span",{className:o.helpDot,style:{backgroundColor:"rgba(77,166,255,0.4)"}}),(0,t.jsx)("span",{className:o.helpText,children:"100-200%"}),(0,t.jsx)("span",{className:o.helpDot,style:{backgroundColor:"rgba(134,115,230,0.4)"}}),(0,t.jsx)("span",{className:o.helpText,children:"200-250%"}),(0,t.jsx)("span",{className:o.helpTip,children:"\u53EF\u4EE5\u62D6\u62FD\u9F20\u6807\u9009\u62E9\u6295\u653E\u65F6\u6BB5"})]})]})]})})}}]),u}(E.Component),ge=ye,Se=function(){var c=(0,E.useState)([]),u=$()(c,2),l=u[0],e=u[1];return(0,t.jsx)(G._z,{header:{style:{borderBottom:"1px solid #ddd"},title:"\u5206\u65F6\u6298\u6263",onBack:function(){return z.m8.push("/")}},children:(0,t.jsx)(ge,{value:l,onChange:function(a){return e(a)}})})},xe=Se}}]);
